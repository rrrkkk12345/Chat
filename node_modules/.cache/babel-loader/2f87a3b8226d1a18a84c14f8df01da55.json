{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rei.kawasato/Desktop/travel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/rei.kawasato/Desktop/travel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/rei.kawasato/Desktop/travel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/rei.kawasato/Desktop/travel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/rei.kawasato/Desktop/travel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef}from'react';import{makeStyles,TextField,Grid,Button,ListItemAvatar,Avatar,List}from'@material-ui/core';import ListItem from'@material-ui/core/ListItem';import useReactRouter from'use-react-router';// import classes from '*.module.css';\nimport HeaderChat from'./headerChat';import userIcon from'../assets/test.png';import jsonDataTest from'../utils/db2.json';var UserIcon=require('../assets/test.png');var TabChatOn=require('../assets/TabChatOn.png');var TabMapOff=require('../assets/TabMapOff.png');var Tap=require('../assets/Tap.png');var useStyles=makeStyles(function(theme){return{chatDesign:{position:\"fixed\",width:\"100%\",backgroundColor:\"#EFEDE9\",top:\"10%\",bottom:\"25%\",overflow:\"auto\"},buttonDesign:{bottom:\"30%\",position:\"fixed\",borderRadius:\"50%\",// backgroundColor: \"blue\",\ncolor:\"white\",// zIndex:100,\nmarginLeft:\"40%\",fontFamily:'メイリオ'// cursor: \"pointer\",\n},selectButton:{width:\"100%\",minHeight:'10%',// height: '10%',\njustifyItems:'center',textAlign:'center',padding:'30px 0',position:'fixed',bottom:\"10%\",backgroundColor:'EFEDE9'// zIndex:500,\n},narrator:{fontFamily:'メイリオ',// fontSize: 20,\ndisplay:'flex',alignItems:'top',//縦\ntextAlign:'start',//横\ncolor:\"#994C00\",backgroundColor:'#EEB57D',borderRadius:16,// height: 60,\nwidth:'70%',marginTop:20,alignSelf:'',justifyContent:'flex-start',marginLeft:'15%',padding:10// position:'relative',\n},yuka:{fontFamily:'メイリオ',width:'100%',maxWidth:'25ch',backgroundColor:theme.palette.background.paper,borderRadius:20,borderColor:'blue',padding:10},yuka_label:{fontSize:15,marginBottom:'0%',marginLeft:'20%',marginTop:'5%'},syujiinko:{fontFamily:'メイリオ',border:'solid',color:'#7088b1',borderRadius:20,borderColor:'#bfc8d5',backgroundColor:'#e2e3e4',width:'100%',maxWidth:'30ch',marginLeft:'40%',padding:10},avatar:{// padding: 10,\nmarginLeft:50},square:{width:\"100%\",height:\"900px\",// margin:'0',\nbackgroundColor:\"#eeedea\"},bottomTab:{position:\"fixed\",bottom:\"0\",height:\"10%\",width:\"100%\",backgroundColor:\"#eeedea\",display:\"flex\",flexDirection:\"row\",textAlign:\"center\",justifyContent:\"center\",alignItems:\"center\"},bottomChat:{// border: \"2px solid\",\n// borderColor: \"pink\",\nflex:1},bottomMap:{// border: \"2px solid\",\n// borderColor: \"pink\",\nflex:1},mapLabel:{color:\"#4575b4\",fontWeight:'bold',fontSize:'14px',letterSpacing:'-0.32px',textAlign:'center',bottom:\"13%\",position:\"fixed\",borderRadius:\"50%\",// backgroundColor: \"blue\",\n// zIndex:100,\n// marginLeft: \"40%\",\nfontFamily:'メイリオ'// cursor: \"pointer\",\n}};});var currentSentenceIdInit=\"0\";var genderInit=\"0\";var spotIdInit=\"A\";var spotNameInit=\"大谷資料館\";var scenarioListInit=[{sentenceId:\"0\",nextSentenceId:\"1\",personName:\"優花\",sentence:{plane:\"初期値消したい\",button:[{buttonLabel:\"海外強度料理にしよう\",nextSentenceId:\"21\"},{buttonLabel:\"お蕎麦屋さんにしよう\",nextSentenceId:\"22\"}]},reply:\"true\"}];var isButtonInit=false;var isReplyInit=false;var isBtnLabelInit_1=\"\";var isBtnLabelInit_2=\"\";var isBtnScenarioIdInit_1=\"\";var isBtnScenarioIdInit_2=\"\";var BottomTab=function BottomTab(){var _useReactRouter=useReactRouter(),history=_useReactRouter.history;var classes=useStyles();return/*#__PURE__*/React.createElement(\"div\",{className:classes.bottomTab},/*#__PURE__*/React.createElement(\"div\",{className:classes.bottomChat},/*#__PURE__*/React.createElement(\"img\",{src:TabChatOn}),/*#__PURE__*/React.createElement(\"div\",null,\"\\u30C1\\u30E3\\u30C3\\u30C8\")),/*#__PURE__*/React.createElement(\"div\",{className:classes.bottomMap,onClick:function onClick(){return history.push(\"/map\");}},/*#__PURE__*/React.createElement(\"img\",{src:TabMapOff}),/*#__PURE__*/React.createElement(\"div\",null,\"\\u30DE\\u30C3\\u30D7\")));};var btn1=\"\";var Chat=function Chat(){var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),jsonData=_useState2[0],setJsonData=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),scenarioList=_useState4[0],setScenarioList=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),scenarioLog=_useState6[0],setScenarioLog=_useState6[1];var _useState7=useState(currentSentenceIdInit),_useState8=_slicedToArray(_useState7,2),currentSentenceId=_useState8[0],setCurrentSentenceId=_useState8[1];var _useState9=useState(isButtonInit),_useState10=_slicedToArray(_useState9,2),isButton=_useState10[0],setIsButton=_useState10[1];var _useState11=useState(isReplyInit),_useState12=_slicedToArray(_useState11,2),isReply=_useState12[0],setIsReply=_useState12[1];var _useState13=useState(isBtnLabelInit_1),_useState14=_slicedToArray(_useState13,2),btnLabel_1=_useState14[0],setBtnLabel_1=_useState14[1];var _useState15=useState(isBtnLabelInit_2),_useState16=_slicedToArray(_useState15,2),btnLabel_2=_useState16[0],setBtnLabel_2=_useState16[1];var _useState17=useState(isBtnScenarioIdInit_1),_useState18=_slicedToArray(_useState17,2),btnScenarioId_1=_useState18[0],setBtnScenarioId_1=_useState18[1];var _useState19=useState(isBtnScenarioIdInit_2),_useState20=_slicedToArray(_useState19,2),btnScenarioId_2=_useState20[0],setBtnScenarioId_2=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),btnText=_useState22[0],setBtnText=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),reply=_useState24[0],setReply=_useState24[1];var isFirstRender=useRef(false);var ref=useRef(null);useEffect(function(){var jwt=JSON.parse(localStorage.getItem('jwt'));var Authorization=jwt.Authorization,Accesstoken=jwt.Accesstoken;var scenarioHistString=localStorage.getItem('scenarioHist');// const scenarioHist: string<{ nextSentenceId: string, personName: string, plane: string }> = localStorage.getItem('scenarioHist')\n// const { personName, plane } = scenarioHist\nconsole.log(scenarioHistString);if(scenarioHistString){console.log(\"Localstorage\");var scenarioHist=JSON.parse(scenarioHistString);if(scenarioHist.length>0){setScenarioLog(scenarioHist);setCurrentSentenceId(scenarioHist.slice(-1)[0].nextSentenceId);scrollToBottomOfList();}}else{console.log(\"DB\");//ログから会話履歴をもってくる\nfetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\",{method:'GET',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken}}).then(function(res){return res.json();}).then(function(data){if(data.scenarioHistory.length<=0){localStorage.setItem('scenarioHist',JSON.stringify([]));return;}localStorage.setItem('scenarioHist',JSON.stringify(data.scenarioHistory));// const scenarioGet: Array<{ nextSentenceId: string, personName: string, plane: string }> = JSON.parse(localStorage.getItem('scenarioHist') as string)\nconsole.log(data.scenarioHistory);// DBから最新のIDをとってくる\n// scenarioGet.slice(-1)[0]\nsetScenarioLog(data.scenarioHistory);setCurrentSentenceId(data.scenarioHistory.slice(-1)[0].nextSentenceId);scrollToBottomOfList();});}},[]);useEffect(function(){scrollToBottomOfList();},[scenarioList]);useEffect(function(){scrollToBottomOfList();},[scenarioLog]);var scrollToBottomOfList=React.useCallback(function(){ref.current.scrollIntoView({behavior:'smooth',block:'end'});},[ref]);var selectBtnText=function selectBtnText(scenarioId,planeMessage){scenarioList&&setScenarioList([].concat(_toConsumableArray(scenarioList),[{sentenceId:\"\",nextSentenceId:scenarioId,personName:\"主人公\",sentence:{plane:planeMessage,button:[{buttonLabel:\"\",nextSentenceId:\"\"},{buttonLabel:\"\",nextSentenceId:\"\"}]},reply:\"false\"}]));setCurrentSentenceId(scenarioId);var jwt=JSON.parse(localStorage.getItem('jwt'));var Authorization=jwt.Authorization,Accesstoken=jwt.Accesstoken;fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},// body: JSON.stringify({ scenario: { personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId } })\nbody:JSON.stringify({scenario:{nextSentenceId:scenarioId,personName:\"主人公\",plane:planeMessage}})});var tmpArray=JSON.parse(localStorage.getItem('scenarioHist'));console.log(\"tmpArray:\",tmpArray);tmpArray.push({nextSentenceId:scenarioId,personName:\"主人公\",plane:planeMessage});// localStorage.setItem('scenarioHist', JSON.stringify({ personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId }))\nlocalStorage.setItem('scenarioHist',JSON.stringify(tmpArray));//性別\n// console.log(\"性別\",currentSentenceId)\nif(currentSentenceId===\"1\"){fetch(\"https://jtb-prd.two-choices.jp/api/user/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},body:JSON.stringify({gender:planeMessage})});}};var handleReplyChange=function handleReplyChange(e){setReply(e.target.value);};var replyText=function replyText(id,planeMessage){scenarioList&&setScenarioList([].concat(_toConsumableArray(scenarioList),[{sentenceId:\"\",nextSentenceId:\"\",personName:\"主人公\",sentence:{plane:planeMessage,button:[{buttonLabel:\"\",nextSentenceId:\"\"},{buttonLabel:\"\",nextSentenceId:\"\"}]},reply:\"\"}]));setCurrentSentenceId(id);setIsReply(false);var jwt=JSON.parse(localStorage.getItem('jwt'));var Authorization=jwt.Authorization,Accesstoken=jwt.Accesstoken;fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},// body: JSON.stringify({ scenario: { personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId } })\nbody:JSON.stringify({scenario:{nextSentenceId:id,personName:\"主人公\",plane:planeMessage}})});var tmpArray=JSON.parse(localStorage.getItem('scenarioHist'));console.log(\"tmpArray:\",tmpArray);// tmpArray.push({ personName: \"主人公\", plane: planeMessage })\n// localStorage.setItem('scenarioHist', JSON.stringify({ personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId }))\nlocalStorage.setItem('scenarioHist',JSON.stringify(tmpArray));// }).then(res => res.json()).then(console.log)\n// scrollToBottomOfList()\n//名前\nif(currentSentenceId===\"1\"){fetch(\"https://jtb-prd.two-choices.jp/api/user/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},body:JSON.stringify({name:planeMessage})});}//年齢\nif(currentSentenceId===\"3\"){fetch(\"https://jtb-prd.two-choices.jp/api/user/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},body:JSON.stringify({birth:planeMessage})});}};var processScenario=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(btnId,btnLabel){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.getItem('scenarioHist')){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsButton(false);setIsReply(false);if(!(btnId!=\"\")){_context.next=8;break;}return _context.abrupt(\"return\");case 8://genderはバックエンドでやるのでAccessTokenとAuthorization\n//静的なデータをとってくる\n// fetch(\"http://localhost:3001/posts\")\n//     .then(response => response.json())\n//     .then(jData => {\n//         setJsonData(jData)\njsonDataTest.map(function(scenario){//次もってくる文章に合っているものを抽出\nif(scenario.sentenceId===currentSentenceId){//Filtterつかえる\n//上書き\nscenarioList?setScenarioList([].concat(_toConsumableArray(scenarioList),[_objectSpread({},scenario)]))://新規\nsetScenarioList([_objectSpread({},scenario)]);console.log(\"scenario.nextSentenceId\",scenario.nextSentenceId);console.log(\"scenario.sentence.button[0].buttonLabel\",scenario.sentence.button[0].buttonLabel);// 現在のnextSentenceIdに値が入っている場合\nif(scenario.nextSentenceId!=\"\"){setCurrentSentenceId(scenario.nextSentenceId);}//現在のsentenceにボタンが入っている場合\nif(scenario.sentence.button[0].buttonLabel!=\"\"){setIsButton(true);setBtnScenarioId_1(scenario.sentence.button[0].nextSentenceId);setBtnScenarioId_2(scenario.sentence.button[1].nextSentenceId);setBtnLabel_1(scenario.sentence.button[0].buttonLabel);setBtnLabel_2(scenario.sentence.button[1].buttonLabel);}//返信がテキストで必要な場合\nif(scenario.reply===\"true\"){setIsReply(true);}var jwt=JSON.parse(localStorage.getItem('jwt'));var Authorization=jwt.Authorization,Accesstoken=jwt.Accesstoken;//今表示したものをDBに入れる\nfetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\",{method:'POST',headers:{'Content-Type':'application/json','Authorization':Authorization,'accesstoken':Accesstoken},body:JSON.stringify({scenario:{nextSentenceId:currentSentenceId,personName:scenario.personName,plane:scenario.sentence.plane}})});var tmpArray=JSON.parse(localStorage.getItem('scenarioHist'));console.log(\"tmpArray:\",tmpArray);tmpArray.push({nextSentenceId:scenario.nextSentenceId,personName:scenario.personName,plane:scenario.sentence.plane});localStorage.setItem('scenarioHist',JSON.stringify(tmpArray));}});case 9:case\"end\":return _context.stop();}}},_callee);}));return function processScenario(_x,_x2){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(HeaderChat,{title:\"\"}),/*#__PURE__*/React.createElement(\"div\",{className:classes.chatDesign},scenarioLog&&scenarioLog.map(function(scenario){return scenario.personName==\"優花\"?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:classes.yuka_label},\"\\u512A\\u82B1\"),/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(ListItemAvatar,null,/*#__PURE__*/React.createElement(Avatar,{alt:\"icon\",src:userIcon})),/*#__PURE__*/React.createElement(List,{className:classes.yuka},scenario.plane))):scenario.personName==\"主人公\"?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(List,{className:classes.syujiinko},scenario.plane))):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(List,{className:classes.narrator},scenario.plane)));}),scenarioList&&scenarioList.map(function(scenario){return scenario.personName==\"優花\"?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:classes.yuka_label},\"\\u512A\\u82B1\"),/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(ListItemAvatar,null,/*#__PURE__*/React.createElement(Avatar,{alt:\"icon\",src:userIcon})),/*#__PURE__*/React.createElement(List,{className:classes.yuka},scenario.sentence.plane))):scenario.personName==\"主人公\"?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(List,{className:classes.syujiinko},scenario.sentence.plane))):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(List,{className:classes.narrator},scenario.sentence.plane)));}),/*#__PURE__*/React.createElement(\"div\",{id:\"bottom-of-list\",ref:ref})),isButton==true?/*#__PURE__*/React.createElement(\"div\",{className:classes.selectButton},/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"flex-end\",spacing:4},/*#__PURE__*/React.createElement(Grid,{item:true,xs:4},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",disableElevation:true,onClick:function onClick(){selectBtnText(btnScenarioId_1,btnLabel_1);processScenario(btnScenarioId_1,btnLabel_1);}},btnLabel_1)),/*#__PURE__*/React.createElement(Grid,{item:true,xs:4},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",disableElevation:true,onClick:function onClick(){selectBtnText(btnScenarioId_2,btnLabel_2);processScenario(btnScenarioId_2,btnLabel_2);}},btnLabel_2)))):isReply==true?/*#__PURE__*/React.createElement(\"div\",{className:classes.selectButton},/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"flex-end\"},/*#__PURE__*/React.createElement(Grid,{item:true,xs:6},/*#__PURE__*/React.createElement(TextField,{id:\"standard-basic\",label:\"\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\",onChange:function onChange(e){return handleReplyChange(e);}})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:3},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",disableElevation:true,onClick:function onClick(){return replyText(currentSentenceId,reply);}},\"\\u9001\\u4FE1\"))))// : currentSentenceId === \"5\" ?\n//     <div className={classes.mapLabel}>\n//         目的地に到着したら下のマップページでチェックインしてシナリオを進めましょう\n//     </div>\n:/*#__PURE__*/React.createElement(\"img\",{className:classes.buttonDesign,src:Tap,onClick:function onClick(){processScenario(\"\",\"\");}})// <button className={classes.buttonDesign} onClick={() => { processScenario(\"\", \"\") }}>↑</button>\n,/*#__PURE__*/React.createElement(BottomTab,null));};export default Chat;","map":{"version":3,"sources":["/Users/rei.kawasato/Desktop/travel/src/pages/chat.tsx"],"names":["React","useEffect","useState","useRef","makeStyles","TextField","Grid","Button","ListItemAvatar","Avatar","List","ListItem","useReactRouter","HeaderChat","userIcon","jsonDataTest","UserIcon","require","TabChatOn","TabMapOff","Tap","useStyles","theme","chatDesign","position","width","backgroundColor","top","bottom","overflow","buttonDesign","borderRadius","color","marginLeft","fontFamily","selectButton","minHeight","justifyItems","textAlign","padding","narrator","display","alignItems","marginTop","alignSelf","justifyContent","yuka","maxWidth","palette","background","paper","borderColor","yuka_label","fontSize","marginBottom","syujiinko","border","avatar","square","height","bottomTab","flexDirection","bottomChat","flex","bottomMap","mapLabel","fontWeight","letterSpacing","currentSentenceIdInit","genderInit","spotIdInit","spotNameInit","scenarioListInit","sentenceId","nextSentenceId","personName","sentence","plane","button","buttonLabel","reply","isButtonInit","isReplyInit","isBtnLabelInit_1","isBtnLabelInit_2","isBtnScenarioIdInit_1","isBtnScenarioIdInit_2","BottomTab","history","classes","push","btn1","Chat","jsonData","setJsonData","scenarioList","setScenarioList","scenarioLog","setScenarioLog","currentSentenceId","setCurrentSentenceId","isButton","setIsButton","isReply","setIsReply","btnLabel_1","setBtnLabel_1","btnLabel_2","setBtnLabel_2","btnScenarioId_1","setBtnScenarioId_1","btnScenarioId_2","setBtnScenarioId_2","btnText","setBtnText","setReply","isFirstRender","ref","jwt","JSON","parse","localStorage","getItem","Authorization","Accesstoken","scenarioHistString","console","log","scenarioHist","length","slice","scrollToBottomOfList","fetch","method","headers","then","res","json","data","scenarioHistory","setItem","stringify","useCallback","current","scrollIntoView","behavior","block","selectBtnText","scenarioId","planeMessage","body","scenario","tmpArray","gender","handleReplyChange","e","target","value","replyText","id","name","birth","processScenario","btnId","btnLabel","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\nimport { Typography, makeStyles, TextField, Grid, Box, Button, ListItemAvatar, Avatar, List } from '@material-ui/core'\nimport ListItem from '@material-ui/core/ListItem';\nimport useReactRouter from 'use-react-router';\n// import classes from '*.module.css';\nimport Header from './header';\nimport HeaderChat from './headerChat';\nimport GoogleMapAPI from '../utils/googleMapAPI';\nimport Footer from './footer';\nimport SelectInput from '@material-ui/core/Select/SelectInput';\nimport axios, { AxiosResponse } from 'axios';\nimport { Data, GoogleMap } from '@react-google-maps/api';\nimport userIcon from '../assets/test.png';\nimport { Label } from '@material-ui/icons';\nimport jsonDataTest from '../utils/db2.json';\nconst UserIcon = require('../assets/test.png');\nconst TabChatOn = require('../assets/TabChatOn.png');\nconst TabMapOff = require('../assets/TabMapOff.png');\nconst Tap = require('../assets/Tap.png');\n\n\n\nconst useStyles = makeStyles((theme) => ({\n    chatDesign: {\n        position: \"fixed\",\n        width: \"100%\",\n        backgroundColor: \"#EFEDE9\",\n        top: \"10%\",\n        bottom: \"25%\",\n        overflow: \"auto\"\n\n    },\n    buttonDesign: {\n        bottom: \"30%\",\n        position: \"fixed\",\n        borderRadius: \"50%\",\n        // backgroundColor: \"blue\",\n        color: \"white\",\n        // zIndex:100,\n        marginLeft: \"40%\",\n        fontFamily: 'メイリオ',\n        // cursor: \"pointer\",\n    },\n    selectButton: {\n        width: \"100%\",\n        minHeight: '10%',\n        // height: '10%',\n        justifyItems: 'center',\n        textAlign: 'center',\n        padding: '30px 0',\n        position: 'fixed',\n        bottom: \"10%\",\n        backgroundColor: 'EFEDE9',\n        // zIndex:500,\n    },\n    narrator: {\n        fontFamily: 'メイリオ',\n        // fontSize: 20,\n        display: 'flex',\n        alignItems: 'top',//縦\n        textAlign: 'start',//横\n        color: \"#994C00\",\n        backgroundColor: '#EEB57D',\n        borderRadius: 16,\n        // height: 60,\n        width: '70%',\n        marginTop: 20,\n        alignSelf: '',\n        justifyContent: 'flex-start',\n        marginLeft: '15%',\n        padding: 10,\n        // position:'relative',\n    },\n    yuka: {\n        fontFamily: 'メイリオ',\n        width: '100%',\n        maxWidth: '25ch',\n        backgroundColor: theme.palette.background.paper,\n        borderRadius: 20,\n        borderColor: 'blue',\n        padding: 10,\n    },\n    yuka_label: {\n        fontSize: 15,\n        marginBottom: '0%',\n        marginLeft: '20%',\n        marginTop: '5%',\n    },\n    syujiinko: {\n        fontFamily: 'メイリオ',\n        border: 'solid',\n        color: '#7088b1',\n        borderRadius: 20,\n        borderColor: '#bfc8d5',\n        backgroundColor: '#e2e3e4',\n        width: '100%',\n        maxWidth: '30ch',\n        marginLeft: '40%',\n        padding: 10,\n    },\n    avatar: {\n        // padding: 10,\n        marginLeft: 50,\n    },\n    square: {\n        width: \"100%\",\n        height: \"900px\",\n        // margin:'0',\n        backgroundColor: \"#eeedea\",\n    },\n    bottomTab: {\n        position: \"fixed\",\n        bottom: \"0\",\n        height: \"10%\",\n        width: \"100%\",\n        backgroundColor: \"#eeedea\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        textAlign: \"center\",\n        justifyContent: \"center\",\n        alignItems: \"center\"\n    },\n    bottomChat: {\n        // border: \"2px solid\",\n        // borderColor: \"pink\",\n        flex: 1,\n    },\n    bottomMap: {\n        // border: \"2px solid\",\n        // borderColor: \"pink\",\n        flex: 1,\n    },\n    mapLabel: {\n        color: \"#4575b4\",\n        fontWeight: 'bold',\n        fontSize: '14px',\n        letterSpacing: '-0.32px',\n        textAlign: 'center',\n        bottom: \"13%\",\n        position: \"fixed\",\n        borderRadius: \"50%\",\n        // backgroundColor: \"blue\",\n        // zIndex:100,\n        // marginLeft: \"40%\",\n        fontFamily: 'メイリオ',\n        // cursor: \"pointer\",\n    },\n}))\n\ntype JsonData = {\n    sentenceId: string\n    nextSentenceId: string\n    personName: string\n    sentence: {\n        plane: string,\n        button: Array<{\n            buttonLabel: string,\n            nextSentenceId: string\n        }>\n    }\n    reply: string\n}\ntype LogData = {\n    // id: string\n    personName: string\n    plane: string,\n\n}\n\n\nconst currentSentenceIdInit: string = \"0\"\nconst genderInit: string = \"0\"\nconst spotIdInit: string = \"A\"\nconst spotNameInit: string = \"大谷資料館\"\nconst scenarioListInit = [\n    {\n        sentenceId: \"0\",\n        nextSentenceId: \"1\",\n        personName: \"優花\",\n        sentence: {\n            plane: \"初期値消したい\",\n            button: [\n                {\n                    buttonLabel: \"海外強度料理にしよう\",\n                    nextSentenceId: \"21\"\n                },\n                {\n                    buttonLabel: \"お蕎麦屋さんにしよう\",\n                    nextSentenceId: \"22\"\n                }\n            ],\n        },\n        reply: \"true\"\n    }\n]\n\nconst isButtonInit = false\nconst isReplyInit = false\nconst isBtnLabelInit_1 = \"\"\nconst isBtnLabelInit_2 = \"\"\nconst isBtnScenarioIdInit_1 = \"\"\nconst isBtnScenarioIdInit_2 = \"\"\n\nconst BottomTab: React.FC = () => {\n    const { history } = useReactRouter();\n    const classes = useStyles()\n    return (\n\n        <div className={classes.bottomTab}>\n            <div className={classes.bottomChat}>\n\n                <img src={TabChatOn} />\n                <div>\n                    チャット\n                </div>\n            </div>\n            <div className={classes.bottomMap} onClick={() => history.push(\"/map\")}>\n\n                <img src={TabMapOff} />\n                <div>\n                    マップ\n                </div>\n            </div>\n        </div>\n    )\n}\n\nvar btn1: string = \"\"\nconst Chat: React.FC = () => {\n\n\n    const classes = useStyles()\n    const [jsonData, setJsonData] = useState<JsonData[]>()\n    const [scenarioList, setScenarioList] = useState<JsonData[]>()\n    const [scenarioLog, setScenarioLog] = useState<LogData[]>()\n    const [currentSentenceId, setCurrentSentenceId] = useState(currentSentenceIdInit);\n    const [isButton, setIsButton] = useState(isButtonInit)\n    const [isReply, setIsReply] = useState(isReplyInit)\n    const [btnLabel_1, setBtnLabel_1] = useState(isBtnLabelInit_1)\n    const [btnLabel_2, setBtnLabel_2] = useState(isBtnLabelInit_2)\n    const [btnScenarioId_1, setBtnScenarioId_1] = useState(isBtnScenarioIdInit_1)\n    const [btnScenarioId_2, setBtnScenarioId_2] = useState(isBtnScenarioIdInit_2)\n    const [btnText, setBtnText] = useState(\"\")\n    const [reply, setReply] = useState(\"\")\n    const isFirstRender = useRef(false)\n\n\n    const ref = useRef<any>(null)\n\n    useEffect(() => {\n\n        const jwt = JSON.parse(localStorage.getItem('jwt') as string)\n        const { Authorization, Accesstoken } = jwt\n        const scenarioHistString: string | null = localStorage.getItem('scenarioHist')\n        // const scenarioHist: string<{ nextSentenceId: string, personName: string, plane: string }> = localStorage.getItem('scenarioHist')\n        // const { personName, plane } = scenarioHist\n\n        console.log(scenarioHistString)\n        if (scenarioHistString) {\n            console.log(\"Localstorage\")\n            const scenarioHist: Array<{ nextSentenceId: string, personName: string, plane: string }> = JSON.parse(scenarioHistString)\n            if (scenarioHist.length > 0) {\n\n                setScenarioLog(scenarioHist)\n                setCurrentSentenceId(scenarioHist.slice(-1)[0].nextSentenceId)\n                scrollToBottomOfList()\n            }\n        } else {\n            console.log(\"DB\")\n\n            //ログから会話履歴をもってくる\n\n            fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\", {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': Authorization,\n                    'accesstoken': Accesstoken\n                },\n            }).then(res => res.json()).then(data => {\n\n\n\n                if (data.scenarioHistory.length <= 0) {\n\n                    localStorage.setItem('scenarioHist', JSON.stringify([]))\n                    return\n                }\n                localStorage.setItem('scenarioHist', JSON.stringify(data.scenarioHistory))\n                // const scenarioGet: Array<{ nextSentenceId: string, personName: string, plane: string }> = JSON.parse(localStorage.getItem('scenarioHist') as string)\n                console.log(data.scenarioHistory)\n\n                // DBから最新のIDをとってくる\n                // scenarioGet.slice(-1)[0]\n\n                setScenarioLog(data.scenarioHistory)\n                setCurrentSentenceId(data.scenarioHistory.slice(-1)[0].nextSentenceId)\n                scrollToBottomOfList()\n\n\n            })\n        }\n    }, [])\n\n    useEffect(() => {\n        scrollToBottomOfList()\n    }, [scenarioList])\n\n\n    useEffect(() => {\n        scrollToBottomOfList()\n    }, [scenarioLog])\n\n\n    const scrollToBottomOfList = React.useCallback(() => {\n        ref!.current!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'end',\n        })\n    }, [ref])\n\n    const selectBtnText = (scenarioId: string, planeMessage: string) => {\n        scenarioList && setScenarioList([...scenarioList, {\n            sentenceId: \"\",\n            nextSentenceId: scenarioId,\n            personName: \"主人公\",\n            sentence: {\n                plane: planeMessage,\n                button: [\n                    {\n                        buttonLabel: \"\",\n                        nextSentenceId: \"\"\n                    },\n                    {\n                        buttonLabel: \"\",\n                        nextSentenceId: \"\"\n                    }\n                ]\n            },\n            reply: \"false\"\n        }])\n        setCurrentSentenceId(scenarioId)\n        const jwt = JSON.parse(localStorage.getItem('jwt') as string)\n        const { Authorization, Accesstoken } = jwt\n        fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\", {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': Authorization,\n                'accesstoken': Accesstoken\n            },\n            // body: JSON.stringify({ scenario: { personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId } })\n            body: JSON.stringify({ scenario: { nextSentenceId:scenarioId, personName: \"主人公\", plane: planeMessage } })\n        })\n        const tmpArray = JSON.parse(localStorage.getItem('scenarioHist') as string)\n        console.log(\"tmpArray:\", tmpArray)\n        tmpArray.push({ nextSentenceId:scenarioId,personName: \"主人公\", plane: planeMessage })\n        // localStorage.setItem('scenarioHist', JSON.stringify({ personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId }))\n        localStorage.setItem('scenarioHist', JSON.stringify(tmpArray))\n\n        //性別\n        // console.log(\"性別\",currentSentenceId)\n        if (currentSentenceId === \"1\") {\n            fetch(\"https://jtb-prd.two-choices.jp/api/user/\", {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': Authorization,\n                    'accesstoken': Accesstoken\n                },\n                body: JSON.stringify({ gender: planeMessage })\n            })\n        }\n    }\n\n\n    const handleReplyChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setReply(e.target.value)\n    }\n\n    const replyText = (id: string, planeMessage: string) => {\n\n        scenarioList && setScenarioList([...scenarioList, {\n            sentenceId: \"\",\n            nextSentenceId: \"\",\n            personName: \"主人公\",\n            sentence: {\n                plane: planeMessage,\n                button: [\n                    {\n                        buttonLabel: \"\",\n                        nextSentenceId: \"\"\n                    },\n                    {\n                        buttonLabel: \"\",\n                        nextSentenceId: \"\"\n                    }\n                ]\n            },\n            reply: \"\"\n        }])\n        setCurrentSentenceId(id)\n        setIsReply(false)\n        const jwt = JSON.parse(localStorage.getItem('jwt') as string)\n        const { Authorization, Accesstoken } = jwt\n        fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\", {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': Authorization,\n                'accesstoken': Accesstoken\n            },\n            // body: JSON.stringify({ scenario: { personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId } })\n            body: JSON.stringify({ scenario: { nextSentenceId:id,personName: \"主人公\", plane: planeMessage } })\n        })\n        const tmpArray = JSON.parse(localStorage.getItem('scenarioHist') as string)\n        console.log(\"tmpArray:\", tmpArray)\n        // tmpArray.push({ personName: \"主人公\", plane: planeMessage })\n        // localStorage.setItem('scenarioHist', JSON.stringify({ personName: scenario.personName, plane: scenario.sentence.plane, nextSentenceId: scenario.nextSentenceId }))\n        localStorage.setItem('scenarioHist', JSON.stringify(tmpArray))\n        // }).then(res => res.json()).then(console.log)\n        // scrollToBottomOfList()\n\n        //名前\n        if(currentSentenceId===\"1\"){\n            fetch(\"https://jtb-prd.two-choices.jp/api/user/\", {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': Authorization,\n                'accesstoken': Accesstoken\n            },\n            body: JSON.stringify({ name:planeMessage })\n        })\n        }\n        //年齢\n        if(currentSentenceId===\"3\"){\n            fetch(\"https://jtb-prd.two-choices.jp/api/user/\", {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': Authorization,\n                'accesstoken': Accesstoken\n            },\n            body: JSON.stringify({ birth:planeMessage })\n        })\n        }\n    }\n    const processScenario = async (btnId: string, btnLabel: string) => {\n        // setCurrentSentenceId(\"0\")\n        // console.log(jsonDataTest)\n        if(!localStorage.getItem('scenarioHist')) return \n\n        setIsButton(false)\n        setIsReply(false)\n        if (btnId != \"\") {\n            return\n        } else {\n            //genderはバックエンドでやるのでAccessTokenとAuthorization\n            //静的なデータをとってくる\n            // fetch(\"http://localhost:3001/posts\")\n            //     .then(response => response.json())\n            //     .then(jData => {\n            //         setJsonData(jData)\n            jsonDataTest.map((scenario: any) => {\n                //次もってくる文章に合っているものを抽出\n                if (scenario.sentenceId === currentSentenceId) { //Filtterつかえる\n                    //上書き\n                    scenarioList ? setScenarioList([...scenarioList,\n                    { ...scenario }\n                    ]) :\n                        //新規\n                        setScenarioList([\n                            { ...scenario }\n\n                        ])\n                    console.log(\"scenario.nextSentenceId\", scenario.nextSentenceId)\n                    console.log(\"scenario.sentence.button[0].buttonLabel\", scenario.sentence.button[0].buttonLabel)\n                    // 現在のnextSentenceIdに値が入っている場合\n                    if (scenario.nextSentenceId != \"\") {\n                        setCurrentSentenceId(scenario.nextSentenceId)\n                    }\n                    //現在のsentenceにボタンが入っている場合\n                    if (scenario.sentence.button[0].buttonLabel != \"\") {\n                        setIsButton(true)\n                        setBtnScenarioId_1(scenario.sentence.button[0].nextSentenceId)\n                        setBtnScenarioId_2(scenario.sentence.button[1].nextSentenceId)\n                        setBtnLabel_1(scenario.sentence.button[0].buttonLabel)\n                        setBtnLabel_2(scenario.sentence.button[1].buttonLabel)\n                    }\n                    //返信がテキストで必要な場合\n                    if (scenario.reply === \"true\") {\n                        setIsReply(true)\n                    }\n                    const jwt = JSON.parse(localStorage.getItem('jwt') as string)\n                    const { Authorization, Accesstoken } = jwt\n\n                    //今表示したものをDBに入れる\n                    fetch(\"https://jtb-prd.two-choices.jp/api/scenario/log/\", {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': Authorization,\n                            'accesstoken': Accesstoken\n                        },\n                        body: JSON.stringify({ scenario: { nextSentenceId: currentSentenceId, personName: scenario.personName, plane: scenario.sentence.plane } })\n                    })\n                    const tmpArray = JSON.parse(localStorage.getItem('scenarioHist') as string)\n                    console.log(\"tmpArray:\", tmpArray)\n                    tmpArray.push({ nextSentenceId: scenario.nextSentenceId, personName: scenario.personName, plane: scenario.sentence.plane })\n                    localStorage.setItem('scenarioHist', JSON.stringify(tmpArray))\n                }\n            })\n        }\n    }\n\n    return (\n        <div>\n\n            <HeaderChat title=\"\" />\n\n            <div className={classes.chatDesign}>\n                {scenarioLog && scenarioLog.map((scenario: any) => scenario.personName == \"優花\" ?\n                    <div>\n                        <div className={classes.yuka_label}>優花</div>\n\n                        <ListItem>\n                            <ListItemAvatar>\n                                <Avatar alt=\"icon\" src={userIcon} />\n                            </ListItemAvatar>\n                            <List className={classes.yuka}>{scenario.plane}</List>\n                        </ListItem>\n                    </div>\n                    : scenario.personName == \"主人公\" ?\n                        <div>\n                            <ListItem>\n                                <List className={classes.syujiinko}>{scenario.plane}</List>\n                            </ListItem>\n                        </div>\n                        :\n                        <div>\n                            <ListItem>\n                                <List className={classes.narrator}>{scenario.plane}</List>\n                            </ListItem>\n                        </div>\n                )}\n                {scenarioList && scenarioList.map((scenario: any) => scenario.personName == \"優花\" ?\n                    <div>\n                        <div className={classes.yuka_label}>優花</div>\n\n                        <ListItem>\n                            <ListItemAvatar>\n                                <Avatar alt=\"icon\" src={userIcon} />\n                            </ListItemAvatar>\n                            <List className={classes.yuka}>{scenario.sentence.plane}</List>\n                        </ListItem>\n                    </div>\n                    : scenario.personName == \"主人公\" ?\n                        <div>\n                            <ListItem>\n                                <List className={classes.syujiinko}>{scenario.sentence.plane}</List>\n                            </ListItem>\n                        </div>\n                        :\n                        <div>\n                            <ListItem>\n                                <List className={classes.narrator}>{scenario.sentence.plane}</List>\n                            </ListItem>\n                        </div>\n                )}\n\n\n\n\n                <div id=\"bottom-of-list\" ref={ref} />\n            </div>\n            {isButton == true ?\n                <div className={classes.selectButton}>\n                    <Grid container justify=\"center\" alignItems=\"flex-end\" spacing={4}>\n                        <Grid item xs={4}>\n                            <Button\n                                variant=\"contained\"\n                                disableElevation\n                                onClick={() => {\n                                    selectBtnText(btnScenarioId_1, btnLabel_1)\n                                    processScenario(btnScenarioId_1, btnLabel_1)\n                                }}\n                            >\n                                {btnLabel_1}\n                            </Button>\n\n                        </Grid>\n                        <Grid item xs={4}>\n                            <Button\n                                variant=\"contained\"\n                                disableElevation\n                                onClick={() => {\n                                    selectBtnText(btnScenarioId_2, btnLabel_2)\n                                    processScenario(btnScenarioId_2, btnLabel_2)\n                                }}\n                            >\n                                {btnLabel_2}\n                            </Button>\n\n                        </Grid>\n                    </Grid>\n                    {/* <button onClick={() => {\n                        selectBtnText(btnScenarioId_1, btnLabel_1)\n                        processScenario(btnScenarioId_1, btnLabel_1)\n                    }}>{btnLabel_1}</button>\n                    <button onClick={() => {\n                        selectBtnText(btnScenarioId_2, btnLabel_2)\n                        processScenario(btnScenarioId_2, btnLabel_2)\n                    }}>{btnLabel_2}</button> */}\n                </div>\n                : isReply == true ?\n                    <div className={classes.selectButton}>\n                        <Grid container justify=\"center\" alignItems=\"flex-end\">\n                            <Grid item xs={6}>\n                                <TextField id=\"standard-basic\" label=\"入力してください\" onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                                    handleReplyChange(e)\n                                } />\n\n                            </Grid>\n                            <Grid item xs={3}>\n                                <Button\n                                    variant=\"contained\"\n                                    disableElevation\n                                    onClick={() => replyText(currentSentenceId, reply)}\n                                >\n                                    送信\n                                </Button>\n\n                            </Grid>\n                        </Grid>\n                        {/* <input\n                            id=\"replyText\"\n                            type=\"input\"\n                            name=\"reply\"\n                            placeholder=\"ここに入力して送信ボタンを押してください\"\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                                handleReplyChange(e)\n                            }\n                        /> */}\n                        {/* <button onClick={() => {\n                            replyText(currentSentenceId, reply)\n                            // processScenario(btnScenarioId_1, \"0\")\n                        }}>送信</button> */}\n                    </div>\n                    // : currentSentenceId === \"5\" ?\n                    //     <div className={classes.mapLabel}>\n                    //         目的地に到着したら下のマップページでチェックインしてシナリオを進めましょう\n                    //     </div>\n                        :\n                        <img className={classes.buttonDesign} src={Tap} onClick={() => { processScenario(\"\", \"\") }} />\n                // <button className={classes.buttonDesign} onClick={() => { processScenario(\"\", \"\") }}>↑</button>\n\n            }\n            <BottomTab />\n            {/* <Footer /> */}\n        </div>\n    )\n}\n\n\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}